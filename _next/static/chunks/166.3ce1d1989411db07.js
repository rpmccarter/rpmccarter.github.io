"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{6081:function(e,t){t.Vl=void 0;var r,n,i,o=RegExp((r||(n=['\ns*                     # Leading whitespace\n(?=(                      # Mimic "(?>)" -> http://blog.stevenlevithan.com/archives/mimic-atomic-groups\n  ([^s\\\'"]+)          # Normal words\n  |                       #\n  \'([^\']*)\'              # Stuff in single quotes\n  |                       #\n  "((?:[^"\\]|\\.)*)"    # Stuff in double quotes\n  |                       #\n  (\\.?)                  # Escaped character\n  |                       #\n  (S)                    # Garbage\n))1                      #\n(s|$)?                 # Seperator\n'],i=['\n\\s*                     # Leading whitespace\n(?=(                      # Mimic "(?>)" -> http://blog.stevenlevithan.com/archives/mimic-atomic-groups\n  ([^\\s\\\\\\\'\\"]+)          # Normal words\n  |                       #\n  \'([^\\\']*)\'              # Stuff in single quotes\n  |                       #\n  "((?:[^\\"\\\\]|\\\\.)*)"    # Stuff in double quotes\n  |                       #\n  (\\\\.?)                  # Escaped character\n  |                       #\n  (\\S)                    # Garbage\n))\\1                      #\n(\\s|$)?                 # Seperator\n'],Object.defineProperty?Object.defineProperty(n,"raw",{value:i}):n.raw=i,r=n)).raw[0].replace(/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,""),"m");function a(e,t){var r=[],n="",i="";return!function(e,t,r){for(var n,i="";e.length;)(n=e.match(t))?(i+=e.slice(0,n.index)+r(n),e=e.slice(n.index+n[0].length)):(i+=e,e="")}(e,o,function(e){var o=e[0],a=e[2],s=e[3],l=e[4],c=e[5],d=e[6],u=e[7];if("string"==typeof d)throw Error("Unmatched quote");if(i+=o,n+=a||s||l&&l.replace(/\\([$`"\\\n])/g,"$1")||(c||"").replace(/\\(.)/g,"$1"),"string"==typeof u||""===s||""===l)return r.push(n),"function"==typeof t&&t(i),i="",n=""}),n&&(r.push(n),"function"==typeof t&&t(i)),r}function s(e){return e?e.replace(/[^A-Za-z0-9_\-.,:+\/@\n]/g,"\\$&").replace(/\n/g,"'\n'"):"''"}function l(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(s(n))}return t.join(" ")}t.Vl=a,new function(){this.split=a,this.escape=s,this.join=l}},166:function(e,t,r){let n,i;r.r(t),r.d(t,{default:function(){return ei}});var o,a,s,l=r(3827),c=r(4090);let d=e=>{let{char:t}=e;return(0,l.jsx)("span",{className:"animate-blink whitespace-pre",children:null!=t?t:" "})},u=e=>{let t=(0,c.useCallback)(t=>{t.metaKey||t.ctrlKey||t.key.length>1||(t.preventDefault(),null==e||e(t.key))},[e]);(0,c.useEffect)(()=>(addEventListener("keydown",t),()=>removeEventListener("keydown",t)),[t])},f=(e,t)=>{let r=(0,c.useCallback)(r=>{("string"==typeof e?r.key===e:e.includes(r.key))&&(r.preventDefault(),null==t||t(r.key))},[t,e]);(0,c.useEffect)(()=>(addEventListener("keydown",r),()=>removeEventListener("keydown",r)),[r])};var m=r(7259);let h=e=>{let{submitLine:t,prompt:r,autocomplete:n}=e,[i,o]=(0,c.useState)(""),[a,s]=(0,c.useState)(0),[h,p]=(0,c.useState)("");u(e=>{o(t=>t.substring(0,a)+e+t.substring(a)),s(e=>e+1)}),(0,m.x)("a","ctrlKey",()=>s(0)),(0,m.x)("e","ctrlKey",()=>s(i.length)),(0,m.x)("Backspace","metaKey",()=>{o(""),s(0)}),(0,m.x)("u","ctrlKey",()=>{p(i),o(""),s(0)}),(0,m.x)("y","ctrlKey",()=>{o(i.slice(0,a)+h+i.slice(a)),s(e=>e+h.length)}),f("Enter",()=>{t(i)}),f("Tab",()=>{let e=n(i);o(e),s(e.length)}),f("Backspace",()=>{o(e=>e.substring(0,a-1)+e.substring(a)),s(e=>Math.max(e-1,0))}),f("ArrowLeft",()=>{s(e=>Math.max(e-1,0))}),f("ArrowRight",()=>{s(e=>Math.min(e+1,i.length))});let w=i.substring(0,a),y=i.codePointAt(a),g=void 0!==y?String.fromCodePoint(y):void 0,b=i.substring(a+1);return(0,l.jsxs)("div",{className:"whitespace-pre max-w-full text-wrap break-all",children:[r,w,(0,l.jsx)(d,{char:g},a),b]})};var p=r(6081);class w{add(e){let t=this.data;for(let r of e)t.rest[r]||(t.rest[r]={rest:{},end:!1}),t=t.rest[r];t.end=!0}has(e){let t=this.data;for(let r of e){let e=t.rest[r];if(void 0===e)return!1;t=e}return t.end}autocomplete(e){let t=this.data;for(let r of e){let e=t.rest[r];if(void 0===e)return{matchType:"none"};t=e}let r=[];for(;1===Object.keys(t.rest).length&&!t.end;){let e=Object.entries(t.rest)[0];if(void 0===e)throw Error("invariant error: first element of array undefined");let[n,i]=e;r.push(n),t=i}let n=e+r.join("");return 0===Object.keys(t.rest).length?{matchType:"one",match:n}:{matchType:"many",prefix:n,matches:w.getWords(t,n)}}allWords(){return w.getWords(this.data)}static getWords(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=Object.entries(e.rest).flatMap(e=>{let[r,n]=e;return this.getWords(n,t+r)});return e.end&&r.push(t),r}constructor(e){this.data={rest:{},end:!1},null==e||e.forEach(e=>this.add(e))}}let y="rdid",g="wdid";async function b(e){let t=e.objectStore("inodes"),r=e.objectStore("blobs"),n=new Date,i=new Blob(["hello world"]),o=await r.add(i),a=await t.add({mode:"file",size:i.size,accessedTime:n,modifiedTime:n,createdTime:n,linkCount:1,blobId:o}),s=await r.add(new Blob),l=new Map([[".",s],["..",s],["helloWorld.txt",a]]).entries().toArray().map(e=>e.join("	")).join("\n");await r.put(new Blob([l]),s);let c=await t.add({mode:"directory",size:0,accessedTime:n,modifiedTime:n,createdTime:n,linkCount:1,blobId:s});localStorage.setItem(y,c.toString()),localStorage.setItem(g,c.toString()),localStorage.setItem("wd","/")}!function(e){function t(e){return e.startsWith("/")}e.isAbsolute=t,e.normalize=function(e){let r=t(e),n=e.endsWith("/"),i=e.split("/").filter(Boolean),o=[];for(let e of i)"."!==e&&(".."===e?r||0!==o.length&&".."!==o.at(-1)?o.pop():o.push(".."):o.push(e));let a=o.join("/");return""===a?r?"/":".":(r?"/":"")+a+(n?"/":"")}}(s||(s={}));let v=(e,t)=>t.some(t=>e instanceof t),I=new WeakMap,E=new WeakMap,S=new WeakMap,x={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return I.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return j(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function j(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(j(e.result)),n()},o=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",o)});return S.set(t,e),t}(e);if(E.has(e))return E.get(e);let r="function"==typeof(t=e)?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.apply(k(this),r),j(this.request)}:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return j(t.apply(k(this),r))}:(t instanceof IDBTransaction&&function(e){if(I.has(e))return;let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),n()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});I.set(e,t)}(t),v(t,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,x):t;return r!==e&&(E.set(e,r),S.set(r,e)),r}let k=e=>S.get(e),B=["get","getKey","getAll","getAllKeys","count"],D=["put","add","delete","clear"],T=new Map;function L(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(T.get(t))return T.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,i=D.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||B.includes(r)))return;let o=async function(e){for(var t=arguments.length,o=Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];let s=this.transaction(e,i?"readwrite":"readonly"),l=s.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),i&&s.done]))[0]};return T.set(t,o),o}x={...o=x,get:(e,t,r)=>L(e,t)||o.get(e,t,r),has:(e,t)=>!!L(e,t)||o.has(e,t)};let C=["continue","continuePrimaryKey","advance"],A={},M=new WeakMap,O=new WeakMap,W={get(e,t){if(!C.includes(t))return e[t];let r=A[t];return r||(r=A[t]=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];M.set(this,O.get(this)[t](...r))}),r}};async function*N(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=this;if(n instanceof IDBCursor||(n=await n.openCursor(...t)),!n)return;let i=new Proxy(n,W);for(O.set(i,n),S.set(i,k(n));n;)yield i,n=await (M.get(i)||n.continue()),M.delete(i)}function z(e,t){return t===Symbol.asyncIterator&&v(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&v(e,[IDBIndex,IDBObjectStore])}x={...a=x,get:(e,t,r)=>z(e,t)?N:a.get(e,t,r),has:(e,t)=>z(e,t)||a.has(e,t)};let K=function(e,t){let{blocked:r,upgrade:n,blocking:i,terminated:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=indexedDB.open("fs",1),s=j(a);return n&&a.addEventListener("upgradeneeded",e=>{n(j(a.result),e.oldVersion,e.newVersion,j(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),s.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}("fs",1,{upgrade(e,t,r,n){e.createObjectStore("inodes",{autoIncrement:!0}),e.createObjectStore("blobs",{autoIncrement:!0}),b(n)}});async function P(e,t){let r=s.normalize(t),n=r.split("/").filter(Boolean),i=localStorage.getItem(s.isAbsolute(r)?y:g);if(null===i)throw Error("missing inode id");let o=parseInt(i);if(isNaN(o))throw Error("invalid inode id");return V(e,o,n)}async function V(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(void 0===r[n])return t;let{directoryContents:i}=await $(e,t),o=i.get(r[n]);if(void 0===o)throw Error("no such file or directory");return V(e,o,r,n+1)}async function $(e,t){let r=e.transaction(["inodes","blobs"],"readonly"),n=r.objectStore("inodes"),i=r.objectStore("blobs"),o=await n.get(t);if(!o)throw Error("directory inode not found");let{blobId:a,modifiedTime:s}=o,l=await i.get(a);if(!l)throw Error("directory blob not found");return{directoryContents:await F(l),modifiedTime:s}}async function q(e,t,r){let{directoryContents:n,modifiedTime:i}=await $(e,t);if(n.has(r))throw Error("file already exists");let o=e.transaction(["inodes","blobs"],"readwrite"),a=o.objectStore("inodes"),s=o.objectStore("blobs"),l=await a.get(t);if(!l)throw Error("directory inode not found");if(l.modifiedTime>i)throw Error("directory inode write race condition");let c=new Date,d=await s.add(new Blob),u=R(new Map([[".",d],["..",t]]));await s.put(u,d);let f=await a.add({mode:"directory",size:0,accessedTime:c,modifiedTime:c,createdTime:c,linkCount:1,blobId:d});n.set(r,f);let m=R(n);await s.put(m,l.blobId),await a.put({...l,accessedTime:c,modifiedTime:c},t)}async function _(e,t,r){let{directoryContents:n,modifiedTime:i}=await $(e,t),o=n.get(r);if(void 0===o)throw Error("file does not exist");let{directoryContents:a,modifiedTime:s}=await $(e,o);if(a.size>2)throw Error("directory not empty");let l=e.transaction(["inodes","blobs"],"readwrite"),c=l.objectStore("inodes"),d=l.objectStore("blobs"),u=await c.get(t);if(!u)throw Error("parent directory inode not found");if(u.modifiedTime>i)throw Error("parent directory inode write race condition");let f=await c.get(o);if(!f)throw Error("target directory inode not found");if(f.modifiedTime>s)throw Error("target directory inode write race condition");await d.delete(f.blobId),await c.delete(o),n.delete(r);let m=new Date,h=R(n);await d.put(h,u.blobId),await c.put({...u,accessedTime:m,modifiedTime:m},t)}async function F(e){let t=(await e.text()).split("\n").map(e=>{let[t,r,n]=e.split("	",2);if(void 0===t||void 0===r||void 0!==n)throw Error("directory data corrupted");let i=parseInt(r);if(isNaN(i))throw Error("invalid inode number");return[t,i]});return new Map(t)}function R(e){let t=e.entries().toArray().map(e=>e.join("	")).join("\n");return new Blob([t])}function G(e){let t=new Set,r=[],n=!0;for(let i of e)if(n){if("-"===i)n=!1;else if(i.startsWith("-"))for(let e=1;e<i.length;e++){let r=i.at(e);if(void 0===r)break;if("-"===r){let r=i.slice(e+1);""===r?n=!1:t.add(r);break}t.add(r)}else n=!1,r.push(i)}else r.push(i);return{flags:t,positionals:r}}let U=async(e,t)=>{var r;let{flags:n,positionals:i}=G(e),o=n.has("a"),a=await P(await K,null!==(r=i[0])&&void 0!==r?r:""),{directoryContents:s}=await $(await K,a);return t(s.keys().filter(e=>o||!e.startsWith(".")).toArray().join("\n")),0},Z=async(e,t)=>{let{flags:r,positionals:n}=G(e),[i]=n;if(void 0===i)return t("mkdir: must supply directory name"),64;let o=s.normalize(i);if("/"===o)return t("mkdir: /: file exists"),1;o.replace(/\/$/,"");let a=o.lastIndexOf("/"),l=a>-1?o.slice(0,a):"",c=a>-1?o.slice(a+1):o,d=await P(await K,l);return await q(await K,d,c),0},H=async(e,t)=>{let[r]=e;if(void 0===r){let e=localStorage.getItem(y);if(null===e)return t("cd: home directory not found"),2;localStorage.setItem(g,e),localStorage.setItem("wd","/")}else{let e=await P(await K,r),n=s.normalize(r),i=localStorage.getItem("wd");if(null===i)return t("cd: missing directory information"),3;let o=s.isAbsolute(n)?n:s.normalize(i+"/"+n);"/"!==o&&o.endsWith("/")&&(o=o.slice(0,-1)),localStorage.setItem(g,e.toString()),localStorage.setItem("wd",o)}return 0},J=async(e,t)=>{let{flags:r,positionals:n}=G(e),[i]=n;if(void 0===i)return t("rmdir: must supply directory name"),64;let o=s.normalize(i);if("/"===o)return t("rmdir: /: cannot remove root directory"),1;if(o.replace(/\/$/,""),"."===o)return t("rmdir: .: invalid argument"),1;let a=o.lastIndexOf("/"),l=a>-1?o.slice(0,a):"",c=a>-1?o.slice(a+1):o,d=await P(await K,l);return await _(await K,d,c),0},Q=new Map(Object.entries({echo:{executor:(e,t)=>(t(e.join(" ")),0)},ls:{executor:U},mkdir:{executor:Z},rmdir:{executor:J},pwd:{executor:(e,t)=>{let r=localStorage.getItem("wd");return null===r?(t("pwd: missing directory information"),3):(t(r),0)}},cd:{executor:H}})),X=new w(Q.keys().toArray()),Y=async(e,t,r)=>{let n=Q.get(e);return void 0===n?(r("rmsh: command not found: ".concat(e)),127):await n.executor(t,r)},ee=(e,t,r)=>{let n=Q.get(e);if(void 0===n)return{matchType:"none"};let i=n.autocompleter;return i?i(t,r):{matchType:"none"}},et=e=>X.autocomplete(e),er=e=>{var t;let r=(0,p.Vl)(e),n=null!==(t=r[0])&&void 0!==t?t:"";if(n===e)return{replaced:n,result:et(n)};let i=r.slice(1),o=i[i.length-1];return void 0!==o&&e.endsWith(o)?(i.pop(),{replaced:o,result:ee(n,i,o)}):{replaced:"",result:ee(n,i,"")}},en=e=>{let{options:t}=e;return(0,l.jsx)(l.Fragment,{children:t.map((e,t)=>(0,l.jsx)("div",{className:"whitespace-pre break-all",children:e},t))})};function ei(e){let{writeLine:t,onExecutionStart:r,onExecutionEnd:n}=e,[i,o]=(0,c.useState)([]),a=(0,c.useCallback)(async e=>{t("> "+e);let i=(0,p.Vl)(e),o=i[0];if(void 0!==o){r();try{await Y(o,i.slice(1),t)}catch(e){}n()}},[n,r,t]),s=(0,c.useCallback)(e=>{let{replaced:t,result:r}=er(e);switch(r.matchType){case"none":return e;case"one":return eo(e,t,r.match)+" ";case"many":return o(r.matches),eo(e,t,r.prefix)}},[]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h,{prompt:"> ",submitLine:a,autocomplete:s}),i.length>0&&(0,l.jsx)(en,{options:i})]})}let eo=(e,t,r)=>{let n=e.lastIndexOf(t);return e.slice(0,n)+r}}}]);