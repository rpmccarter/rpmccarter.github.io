"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[256],{6081:function(e,t){t.Vl=void 0;var r,n,o,i=RegExp((r||(n=['\ns*                     # Leading whitespace\n(?=(                      # Mimic "(?>)" -> http://blog.stevenlevithan.com/archives/mimic-atomic-groups\n  ([^s\\\'"]+)          # Normal words\n  |                       #\n  \'([^\']*)\'              # Stuff in single quotes\n  |                       #\n  "((?:[^"\\]|\\.)*)"    # Stuff in double quotes\n  |                       #\n  (\\.?)                  # Escaped character\n  |                       #\n  (S)                    # Garbage\n))1                      #\n(s|$)?                 # Seperator\n'],o=['\n\\s*                     # Leading whitespace\n(?=(                      # Mimic "(?>)" -> http://blog.stevenlevithan.com/archives/mimic-atomic-groups\n  ([^\\s\\\\\\\'\\"]+)          # Normal words\n  |                       #\n  \'([^\\\']*)\'              # Stuff in single quotes\n  |                       #\n  "((?:[^\\"\\\\]|\\\\.)*)"    # Stuff in double quotes\n  |                       #\n  (\\\\.?)                  # Escaped character\n  |                       #\n  (\\S)                    # Garbage\n))\\1                      #\n(\\s|$)?                 # Seperator\n'],Object.defineProperty?Object.defineProperty(n,"raw",{value:o}):n.raw=o,r=n)).raw[0].replace(/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,""),"m");function a(e,t){var r=[],n="",o="";return!function(e,t,r){for(var n,o="";e.length;)(n=e.match(t))?(o+=e.slice(0,n.index)+r(n),e=e.slice(n.index+n[0].length)):(o+=e,e="")}(e,i,function(e){var i=e[0],a=e[2],s=e[3],l=e[4],c=e[5],d=e[6],u=e[7];if("string"==typeof d)throw Error("Unmatched quote");if(o+=i,n+=a||s||l&&l.replace(/\\([$`"\\\n])/g,"$1")||(c||"").replace(/\\(.)/g,"$1"),"string"==typeof u||""===s||""===l)return r.push(n),"function"==typeof t&&t(o),o="",n=""}),n&&(r.push(n),"function"==typeof t&&t(o)),r}function s(e){return e?e.replace(/[^A-Za-z0-9_\-.,:+\/@\n]/g,"\\$&").replace(/\n/g,"'\n'"):"''"}function l(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(s(n))}return t.join(" ")}t.Vl=a,new function(){this.split=a,this.escape=s,this.join=l}},8256:function(e,t,r){let n,o;r.r(t),r.d(t,{default:function(){return ef}});var i,a,s,l=r(3827),c=r(4090);function d(e){let{char:t}=e;return(0,l.jsx)("span",{className:"animate-blink whitespace-pre",children:null!=t?t:" "})}let u=(e,t)=>{let r=(0,c.useCallback)(r=>{("string"==typeof e?r.key===e:e.includes(r.key))&&(r.preventDefault(),null==t||t(r.key))},[t,e]);(0,c.useEffect)(()=>(addEventListener("keydown",r),()=>removeEventListener("keydown",r)),[r])};var f=r(7259);function w(e){let{submitLine:t,prompt:r,autocomplete:n}=e,[o,i]=(0,c.useState)(""),[a,s]=(0,c.useState)(0),[w,h]=(0,c.useState)("");!function(e){let t=(0,c.useCallback)(t=>{t.metaKey||t.ctrlKey||t.key.length>1||(t.preventDefault(),null==e||e(t.key))},[e]);(0,c.useEffect)(()=>(addEventListener("keydown",t),()=>removeEventListener("keydown",t)),[t])}(e=>{i(t=>t.substring(0,a)+e+t.substring(a)),s(e=>e+1)}),(0,f.x)("a","ctrlKey",()=>s(0)),(0,f.x)("e","ctrlKey",()=>s(o.length)),(0,f.x)("Backspace","metaKey",()=>{i(""),s(0)}),(0,f.x)("u","ctrlKey",()=>{h(o),i(""),s(0)}),(0,f.x)("y","ctrlKey",()=>{i(o.slice(0,a)+w+o.slice(a)),s(e=>e+w.length)}),u("Enter",()=>{t(o)}),u("Tab",async()=>{let e=await n(o);i(e),s(e.length)}),u("Backspace",()=>{i(e=>e.substring(0,a-1)+e.substring(a)),s(e=>Math.max(e-1,0))}),u("ArrowLeft",()=>{s(e=>Math.max(e-1,0))}),u("ArrowRight",()=>{s(e=>Math.min(e+1,o.length))});let m=o.substring(0,a),p=o.codePointAt(a),y=void 0!==p?String.fromCodePoint(p):void 0,g=o.substring(a+1);return(0,l.jsxs)("div",{className:"whitespace-pre max-w-full text-wrap break-all",children:[r,m,(0,l.jsx)(d,{char:y},a),g]})}var h=r(6081);class m{add(e){let t=this.data;for(let r of e)t.rest[r]||(t.rest[r]={rest:{},end:!1}),t=t.rest[r];t.end=!0}has(e){let t=this.data;for(let r of e){let e=t.rest[r];if(void 0===e)return!1;t=e}return t.end}autocomplete(e){let t=this.data;for(let r of e){let e=t.rest[r];if(void 0===e)return{matchType:"none"};t=e}let r=[];for(;1===Object.keys(t.rest).length&&!t.end;){let e=Object.entries(t.rest)[0];if(void 0===e)throw Error("invariant error: first element of array undefined");let[n,o]=e;r.push(n),t=o}let n=e+r.join("");return 0===Object.keys(t.rest).length?{matchType:"one",match:n}:{matchType:"many",prefix:n,matches:m.getWords(t,n)}}allWords(){return m.getWords(this.data)}static getWords(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=Object.entries(e.rest).flatMap(e=>{let[r,n]=e;return this.getWords(n,t+r)});return e.end&&r.push(t),r}constructor(e){this.data={rest:{},end:!1},null==e||e.forEach(e=>this.add(e))}}let p="rdid",y="wdid";async function g(e){let t=e.objectStore("inodes"),r=e.objectStore("blobs"),n=new Date,o=new Blob(["hello world"]),i=await r.add(o),a=await t.add({mode:"file",size:o.size,accessedTime:n,modifiedTime:n,createdTime:n,linkCount:1,blobId:i}),s=await r.add(new Blob),l=new Map([[".",s],["..",s],["helloWorld.txt",a]]).entries().toArray().map(e=>e.join("	")).join("\n");await r.put(new Blob([l]),s);let c=await t.add({mode:"directory",size:0,accessedTime:n,modifiedTime:n,createdTime:n,linkCount:1,blobId:s});localStorage.setItem(p,c.toString()),localStorage.setItem(y,c.toString()),localStorage.setItem("wd","/"),localStorage.setItem("owd","/")}let b=(e,t)=>t.some(t=>e instanceof t),E=new WeakMap,v=new WeakMap,I=new WeakMap,T={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return E.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return S(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function S(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(S(e.result)),n()},i=()=>{r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",i)});return I.set(t,e),t}(e);if(v.has(e))return v.get(e);let r="function"==typeof(t=e)?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.apply(N(this),r),S(this.request)}:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return S(t.apply(N(this),r))}:(t instanceof IDBTransaction&&function(e){if(E.has(e))return;let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),n()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)});E.set(e,t)}(t),b(t,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,T):t;return r!==e&&(v.set(e,r),I.set(r,e)),r}let N=e=>I.get(e),x=["get","getKey","getAll","getAllKeys","count"],j=["put","add","delete","clear"],O=new Map;function k(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(O.get(t))return O.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,o=j.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(o||x.includes(r)))return;let i=async function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];let s=this.transaction(e,o?"readwrite":"readonly"),l=s.store;return n&&(l=l.index(i.shift())),(await Promise.all([l[r](...i),o&&s.done]))[0]};return O.set(t,i),i}T={...i=T,get:(e,t,r)=>k(e,t)||i.get(e,t,r),has:(e,t)=>!!k(e,t)||i.has(e,t)};let B=["continue","continuePrimaryKey","advance"],D={},A=new WeakMap,C=new WeakMap,L={get(e,t){if(!B.includes(t))return e[t];let r=D[t];return r||(r=D[t]=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];A.set(this,C.get(this)[t](...r))}),r}};async function*M(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=this;if(n instanceof IDBCursor||(n=await n.openCursor(...t)),!n)return;let o=new Proxy(n,L);for(C.set(o,n),I.set(o,N(n));n;)yield o,n=await (A.get(o)||n.continue()),A.delete(o)}function W(e,t){return t===Symbol.asyncIterator&&b(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&b(e,[IDBIndex,IDBObjectStore])}T={...a=T,get:(e,t,r)=>W(e,t)?M:a.get(e,t,r),has:(e,t)=>W(e,t)||a.has(e,t)};let P=function(e,t){let{blocked:r,upgrade:n,blocking:o,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=indexedDB.open("fs",1),s=S(a);return n&&a.addEventListener("upgradeneeded",e=>{n(S(a.result),e.oldVersion,e.newVersion,S(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),s.then(e=>{i&&e.addEventListener("close",()=>i()),o&&e.addEventListener("versionchange",e=>o(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}("fs",1,{upgrade(e,t,r,n){e.createObjectStore("inodes",{autoIncrement:!0}),e.createObjectStore("blobs",{autoIncrement:!0}),g(n)}});function z(e){let t=new Set,r=[],n=!0;for(let o of e)if(n){if("-"===o)n=!1;else if(o.startsWith("-"))for(let e=1;e<o.length;e++){let r=o.at(e);if(void 0===r)break;if("-"===r){let r=o.slice(e+1);""===r?n=!1:t.add(r);break}t.add(r)}else n=!1,r.push(o)}else r.push(o);return{flags:t,positionals:r}}async function R(e){let t=(await e.text()).split("\n").map(e=>{let[t,r,n]=e.split("	",2);if(void 0===t||void 0===r||void 0!==n)throw Error("directory data corrupted");let o=parseInt(r);if(isNaN(o))throw Error("invalid inode number");return[t,o]});return new Map(t)}function K(e){let t=e.entries().toArray().map(e=>e.join("	")).join("\n");return new Blob([t])}class V extends Error{constructor(e,t){super(t),this.code=e}}async function G(e,t){let r=e.transaction(["inodes","blobs"],"readonly"),n=r.objectStore("inodes"),o=r.objectStore("blobs"),i=await n.get(t);if(!i)throw new V("ENOENT","directory inode not found");if("directory"!==i.mode)throw new V("ENOTDIR","inode not a directory");let{blobId:a,modifiedTime:s}=i,l=await o.get(a);if(!l)throw new V("ENOENT","directory blob not found");return{directoryContents:await R(l),modifiedTime:s}}async function $(e,t){let r=t.split("/").filter(Boolean),n=localStorage.getItem(s.isAbsolute(t)?p:y);if(null===n)throw Error("missing inode id");let o=parseInt(n);if(isNaN(o))throw Error("invalid inode id");return q(e,o,r)}async function q(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(void 0===r[n])return t;let{directoryContents:o}=await G(e,t),i=o.get(r[n]);if(void 0===i)throw new V("ENOENT","no such file or directory");return q(e,i,r,n+1)}async function U(e,t){let r=await $(e,t);return await G(e,r)}async function _(e,t){let r=await $(e,t),n=await e.transaction(["inodes"],"readonly").objectStore("inodes").get(r);if(void 0===n)throw new V("ENOENT","inode not found");return n}function F(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return async(t,r)=>{let n=r.lastIndexOf("/"),o=r.slice(n+1),i=r.slice(0,n+1),{directoryContents:a}=await U(await P,i),s=[];for(let t of a.keys())"."!==t&&".."!==t&&(e?"directory"===(await _(await P,i+t)).mode&&s.push(t):s.push(t));if(0===s.length)return{matchType:"none"};let l=new m(s).autocomplete(o);if("none"===l.matchType)return l;if("one"===l.matchType)return"directory"===(await _(await P,i+l.match)).mode?{matchType:"many",prefix:i+l.match+"/",matches:[]}:{matchType:"one",match:i+l.match};let c=[];for(let e of l.matches){let t=await _(await P,i+e);c.push(e+("directory"===t.mode?"/":""))}return{matchType:"many",prefix:i+l.prefix,matches:c}}}async function X(e,t){try{let{directoryContents:r}=await U(await P,e),n=r.keys().filter(e=>t||!e.startsWith(".")).toArray();return{status:"success",path:e,entries:n}}catch(t){return{status:"failure",path:e,reason:t}}}!function(e){function t(e){return e.startsWith("/")}e.isAbsolute=t,e.normalize=function(e){let r=t(e),n=e.endsWith("/"),o=e.split("/").filter(Boolean),i=[];for(let e of o)"."!==e&&(".."===e?r||0!==i.length&&".."!==i.at(-1)?i.pop():i.push(".."):i.push(e));let a=i.join("/");return""===a?r?"/":".":(r?"/":"")+a+(n?"/":"")}}(s||(s={}));let Y={executor:async(e,t)=>{let{flags:r,positionals:n}=z(e),o=r.has("a");0===n.length&&n.push(".");let i=await Promise.all(n.map(e=>X(e,o)));if(1===i.length&&i[0]){let e=i[0];t("failure"===e.status?e.reason instanceof V&&"ENOENT"===e.reason.code?"ls: ".concat(e.path,": no such file or directory"):"ls: ".concat(e.path,": unknown error: ").concat(e.reason):e.entries.join("\n"))}else{let e=!1;for(let r of i)"failure"===r.status?t(r.reason instanceof V&&"ENOENT"===r.reason.code?"ls: ".concat(r.path,": no such file or directory"):"ls: ".concat(r.path,": unknown error: ").concat(r.reason)):(t((e?"\n":"")+"".concat(r.path,":\n")+r.entries.join("\n")),e=!0)}return 0},autocompleter:F()};async function Z(e,t){var r;let n=t.split("/").filter(Boolean),o=s.isAbsolute(t),i=null!==(r=n.pop())&&void 0!==r?r:".",a=(o?"/":"")+n.join("/"),l=await $(e,a),{directoryContents:c,modifiedTime:d}=await U(e,a);if(c.has(i))throw new V("EEXIST","file already exists");let u=e.transaction(["inodes","blobs"],"readwrite"),f=u.objectStore("inodes"),w=u.objectStore("blobs"),h=await f.get(l);if(!h)throw new V("ENOENT","directory inode not found");if(h.modifiedTime>d)throw new V("EIO","directory inode write race condition");let m=new Date,p=await w.add(new Blob),y=K(new Map([[".",p],["..",l]]));await w.put(y,p);let g=await f.add({mode:"directory",size:0,accessedTime:m,modifiedTime:m,createdTime:m,linkCount:1,blobId:p});c.set(i,g);let b=K(c);await w.put(b,h.blobId),await f.put({...h,accessedTime:m,modifiedTime:m},l)}let H={executor:async(e,t)=>{let{positionals:r}=z(e);if(0===r.length)return t("mkdir: must supply directory name"),64;let n=!1;for(let e of r)try{await Z(await P,e)}catch(r){if(n=!0,r instanceof V)"EEXIST"===r.code?t("mkdir: ".concat(e,": file exists")):"ENOENT"===r.code&&t("mkdir: ".concat(e,": no such file or directory"));else throw r}return n?1:0},autocompleter:F(!0)};async function J(e){let t=localStorage.getItem("wd");if(void 0===e){let e=localStorage.getItem(p);if(null===e)throw new V("ENOENT","home directory not found");localStorage.setItem(y,e),localStorage.setItem("wd","/"),t&&localStorage.setItem("owd",t)}else{let r=await $(await P,e),n=await (await P).transaction("inodes","readonly").objectStore("inodes").get(r);if(void 0===n)throw new V("ENOENT","could not load inode");if("directory"!==n.mode)throw new V("ENOTDIR","inode is not a directory");let o=s.normalize(e);if(null===t)throw new V("EGREGIOUS","missing directory information");let i=s.isAbsolute(o)?o:s.normalize(t+"/"+o);"/"!==i&&i.endsWith("/")&&(i=i.slice(0,-1)),localStorage.setItem(y,r.toString()),localStorage.setItem("wd",i),localStorage.setItem("owd",t)}}let Q={executor:async(e,t)=>{let r;if(e.length>2)return t("cd: too many arguments"),1;let[n,o]=e;if(void 0===n)r="/";else if(void 0===o){if("-"===n){let e=localStorage.getItem("owd");if(null===e)return t("cd: missing old pwd"),2;r=e}else r=n}else{let e=localStorage.getItem("wd");if(null===e)return t("cd: missing pwd"),2;if(!e.includes(n))return t("cd: string not in pwd: ".concat(n)),3;r=e.replace(n,o)}try{await J(r)}catch(e){if(e instanceof V){if("ENOENT"===e.code)return t("cd: no such file or directory: ".concat(r)),1;if("ENOTDIR"===e.code)return t("cd: not a directory: ".concat(r)),1}else throw e}return 0},autocompleter:F(!0)};async function ee(e,t){var r;let n=t.split("/").filter(Boolean),o=s.isAbsolute(t),i=null!==(r=n.pop())&&void 0!==r?r:".",a=(o?"/":"")+n.join("/"),l=await $(e,a),{directoryContents:c,modifiedTime:d}=await U(e,a),u=c.get(i);if(void 0===u)throw new V("ENOENT","file does not exist");let f=localStorage.getItem(p);if(null===f)throw new V("EGREGIOUS","missing root dir inode id");let w=parseInt(f);if(isNaN(w))throw new V("EGREGIOUS","invalid root dir inode id");if(u===w)throw new V("EBUSY","cannot delete root directory");let{directoryContents:h,modifiedTime:m}=await U(e,t);if(h.size>2)throw new V("ENOTEMPTY","directory not empty");let y=e.transaction(["inodes","blobs"],"readwrite"),g=y.objectStore("inodes"),b=y.objectStore("blobs"),E=await g.get(l);if(!E)throw new V("ENOENT","parent directory inode not found");if(E.modifiedTime>d)throw new V("EIO","parent directory inode write race condition");let v=await g.get(u);if(!v)throw new V("ENOENT","target directory inode not found");if(v.modifiedTime>m)throw new V("EIO","target directory inode write race condition");await b.delete(v.blobId),await g.delete(u),c.delete(i);let I=new Date,T=K(c);await b.put(T,E.blobId),await g.put({...E,accessedTime:I,modifiedTime:I},l)}let et={executor:async(e,t)=>{let{positionals:r}=z(e);if(0===r.length)return t("rmdir: must supply directory name"),64;let n=!1;for(let e of r){let r=s.normalize(e);if("/"===r)return t("rmdir: /: cannot remove root directory"),1;if("."===(r=r.replace(/\/$/,"")))return t("rmdir: .: invalid argument"),1;try{await ee(await P,e)}catch(r){if(n=!0,r instanceof V)"ENOENT"===r.code?t("rmdir: ".concat(e,": no such file or directory")):"ENOTEMPTY"===r.code?t("rmdir: ".concat(e,": directory not empty")):"ENOTDIR"===r.code&&t("rmdir: ".concat(e,": not a directory"));else throw r}}return n?1:0},autocompleter:F(!0)};async function er(e,t){var r;let n=t.split("/").filter(Boolean),o=s.isAbsolute(t),i=null!==(r=n.pop())&&void 0!==r?r:".",a=(o?"/":"")+n.join("/"),{directoryContents:l}=await U(e,a),c=e.transaction(["inodes","blobs"],"readonly"),d=c.objectStore("inodes"),u=c.objectStore("blobs"),f=l.get(i);if(void 0===f)throw new V("ENOENT","file does not exist");let w=await d.get(f);if(!w)throw new V("ENOENT","file inode not found");if("file"!==w.mode)throw new V("EISDIR","inode is a directory");let{blobId:h}=w,m=await u.get(h);if(!m)throw new V("ENOENT","file blob not found");return m}let en={executor:async(e,t)=>{let{positionals:r}=z(e);if(0===r.length)return 0;let n=!1;for(let e of r)try{let r=await er(await P,e),n=await r.text();t(n)}catch(r){if(n=!0,r instanceof V)"ENOENT"===r.code?t("cat: ".concat(e,": no such file or directory")):"EISDIR"===r.code&&t("cat: ".concat(e,": is a directory"));else throw r}return n?1:0},autocompleter:F()};async function eo(e,t,r){var n;let o=t.split("/").filter(Boolean),i=s.isAbsolute(t),a=null!==(n=o.pop())&&void 0!==n?n:".",l=(i?"/":"")+o.join("/"),c=await $(e,l),{directoryContents:d,modifiedTime:u}=await U(e,l);if(d.has(a))throw new V("EEXIST","file already exists");let f=e.transaction(["inodes","blobs"],"readwrite"),w=f.objectStore("inodes"),h=f.objectStore("blobs"),m=await w.get(c);if(!m)throw new V("ENOENT","directory inode not found");if(m.modifiedTime>u)throw new V("EIO","directory inode write race condition");let p=new Date,y=await h.add(r),g=await w.add({mode:"file",size:r.size,accessedTime:p,modifiedTime:p,createdTime:p,linkCount:1,blobId:y});d.set(a,g);let b=K(d);await h.put(b,m.blobId),await w.put({...m,accessedTime:p,modifiedTime:p},c)}let ei=async(e,t)=>{let{positionals:r}=z(e);if(0===r.length)return t("touch: must supply file name"),1;for(let e of r){try{await _(await P,e);break}catch(e){if(!(e instanceof V&&"ENOENT"===e.code))throw e}await eo(await P,e,new Blob)}return 0},ea=new Map(Object.entries({echo:{executor:(e,t)=>(t(e.join(" ")),0)},ls:Y,mkdir:H,rmdir:et,pwd:{executor:(e,t)=>{let{positionals:r}=z(e);if(r.length)return t("pwd: too many arguments"),1;let n=localStorage.getItem("wd");return null===n?(t("pwd: missing directory information"),3):(t(n),0)}},cd:Q,cat:en,touch:{executor:ei}})),es=new m(ea.keys().toArray()),el=async(e,t,r)=>{let n=ea.get(e);if(void 0===n)return r("rmsh: command not found: ".concat(e)),127;try{return await n.executor(t,r)}catch(e){return console.error(e),r(e instanceof Error?"rmsh: process crashed: ".concat(e.message):"rmsh: process crashed"),127}};async function ec(e,t,r){let n=ea.get(e);if(void 0===n)return{matchType:"none"};let o=n.autocompleter;return o?await o(t,r):{matchType:"none"}}async function ed(e){var t;let r=(0,h.Vl)(e),n=null!==(t=r[0])&&void 0!==t?t:"";if(n===e)return{replaced:n,result:es.autocomplete(n)};let o=r.slice(1),i=o[o.length-1];return void 0!==i&&e.endsWith(i)?(o.pop(),{replaced:i,result:await ec(n,o,i)}):{replaced:"",result:await ec(n,o,"")}}function eu(e){let{options:t}=e;return(0,l.jsx)(l.Fragment,{children:t.map((e,t)=>(0,l.jsx)("div",{className:"whitespace-pre break-all",children:e},t))})}function ef(e){let{writeLine:t,onExecutionStart:r,onExecutionEnd:n}=e,[o,i]=(0,c.useState)([]),a=(0,c.useCallback)(async e=>{t("> "+e);let o=(0,h.Vl)(e),i=o[0];if(void 0!==i){r();try{await el(i,o.slice(1),t)}catch(e){}n()}},[n,r,t]),s=(0,c.useCallback)(async e=>{let{replaced:t,result:r}=await ed(e);switch(r.matchType){case"none":return e;case"one":return ew(e,t,r.match)+" ";case"many":return i(r.matches),ew(e,t,r.prefix)}},[]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w,{prompt:"> ",submitLine:e=>{a(e)},autocomplete:s}),o.length>0&&(0,l.jsx)(eu,{options:o})]})}let ew=(e,t,r)=>{let n=e.lastIndexOf(t);return e.slice(0,n)+r}}}]);